## read data ----
cc <- read.csv('data-raw/COMU_condition.csv',header=T, as.is = T)
## load libraries ----
#library(ggplot2)
library(lubridate)
library(cowplot)
## read data ----
cc <- read.csv('data-raw/COMU_condition.csv',header=T, as.is = T)
## manipulate data ----
cc <- subset(cc, colony == 'Funk')
## manipulate data ----
cc <- subset(cc, colony == 'Funk')
cc[1,]
## manipulate data ----
cc <- subset(cc, COLONY == 'Funk')
cc <- subset(cc, SPECIES == 'COMU')
## load libraries ----
#library(ggplot2)
library(lubridate)
library(cowplot)
## read data ----
cc <- read.csv('data-raw/COMU_condition.csv',header=T, as.is = T)
## manipulate data ----
cc <- subset(cc, colony == 'Funk')
cc <- subset(cc, species == 'COMU')
cc$dates <- dmy(cc$date)
cc$condition <- cc$bird_weight/cc$winglength
str(cc)
cc[which(cc$stage == 'Adult'),'stage'] <- 'adult'
## read data ----
cc <- read.csv('data-raw/COMU_condition.csv',header=T, as.is = T)
## manipulate data ----
cc <- subset(cc, colony == 'Funk')
cc <- subset(cc, species == 'COMU')
str(cc)
## read data ----
cc <- read.csv('data-raw/COMU_condition.csv',header=T, as.is = T)
## manipulate data ----
cc <- subset(cc, colony == 'Funk')
str(cc)
## manipulate data ----
cc <- subset(cc, colony == 'Funk')
cc <- subset(cc, species == 'COMU')
cc$dates <- dmy(cc$date)
cc$condition <- cc$bird_weight/cc$winglength
cc[which(cc$stage == 'Adult'),'stage'] <- 'adult'
unique(cc$stage)
g <- ggplot(cc, aes(year, condition))
g <- g + geom_violin()
g <- g + stat_summary(aes(year), fun.y = median, geom = "point", fill = "black", shape = 21, size = 1.5)
g <- g + xlab("Year") + ylab('Condition')
g <- g + facet_grid(stage ~ .)
g <- g + theme_bw()
print(g)
g <- ggplot(cc, aes(as.factor(year), condition))
g <- g + geom_violin()
g <- g + xlab("Year") + ylab('Condition')
g <- g + facet_grid(stage ~ .)
g <- g + stat_summary(aes(year), fun.y = median, geom = "point", fill = "black", shape = 21, size = 1.5)
g <- g + theme_bw()
print(g)
g <- ggplot(cc, aes(as.factor(year), condition))
g <- g + geom_violin()
g <- g + stat_summary(aes(as.factor(year)), fun.y = median, geom = "point", fill = "black", shape = 21, size = 1.5)
g <- g + xlab("Year") + ylab('Condition')
g <- g + facet_grid(stage ~ .)
g <- g + theme_bw()
print(g)
## read data ----
cc <- read.csv('data-raw/COMU_condition.csv',header=T, as.is = T)
## manipulate data ----
cc <- subset(cc, colony == 'Funk')
cc <- subset(cc, species == 'COMU')
cc$dates <- dmy(cc$date)
cc$condition <- cc$bird_weight/cc$winglength
cc[which(cc$stage == 'Adult'),'stage'] <- 'adult'
g <- ggplot(cc, aes(as.factor(year), condition))
g <- g + geom_violin()
g <- g + stat_summary(aes(as.factor(year)), fun.y = median, geom = "point", fill = "black", shape = 21, size = 1.5)
g <- g + xlab("Year") + ylab('Condition')
g <- g + facet_grid(stage ~ .)
## load libraries ----
#library(ggplot2)
library(lubridate)
library(cowplot)
## read data ----
cc <- read.csv('data-raw/COMU_condition.csv',header=T, as.is = T)
## manipulate data ----
cc <- subset(cc, colony == 'Funk')
cc <- subset(cc, species == 'COMU')
cc$dates <- dmy(cc$date)
cc$condition <- cc$bird_weight/cc$winglength
cc[which(cc$stage == 'Adult'),'stage'] <- 'adult'
g <- ggplot(cc, aes(as.factor(year), condition))
g <- g + geom_violin()
g <- g + stat_summary(aes(as.factor(year)), fun.y = median, geom = "point", fill = "black", shape = 21, size = 1.5)
g <- g + xlab("Year") + ylab('Condition')
g <- g + facet_grid(stage ~ .)
g <- g + theme_bw()
print(g)
library(dplyr)
avw <- cc %>%
filter(stage == 'adult', year > 2003) %>%
filter(complete.cases(bird_weight)) %>%
group_by(year, stage) %>%
summarize(avg = mean(bird_weight))
dif <- max(avw[,3]) - min(avw[,3])
av <-sum(avw[,3])/nrow(avw)
dif/av
adw <- filter(cc, stage == 'adult' & year > 2000)
summary(lm(bird_weight ~ as.integer(year), data = adw))
adw %>%
group_by(year)  %>%
summarise(mean(bird_weight, na.rm =T))
dif
dif/av
avw <- cc %>%
filter(stage == 'adult', year > 1990) %>%
filter(complete.cases(bird_weight)) %>%
group_by(year, stage) %>%
summarize(avg = mean(bird_weight))
avw <- cc %>%
filter(stage == 'adult', year > 1990) %>%
filter(complete.cases(bird_weight)) %>%
group_by(year, stage) %>%
summarize(avg = mean(bird_weight))
dif <- max(avw[,3]) - min(avw[,3])
av <-sum(avw[,3])/nrow(avw)
dif/av
dif
summary(lm(bird_weight ~ as.integer(year), data = adw))
adw %>%
group_by(year)  %>%
summarise(mean(bird_weight, na.rm =T))
adw
avw %>%
group_by(year)  %>%
summarise(mean(bird_weight, na.rm =T))
avw %>%
group_by(year)  %>%
summarise(mean(bird_weight, na.rm =T))
avw
avw <- cc %>%
filter(stage == 'adult', year > 1990) %>%
filter(complete.cases(bird_weight)) %>%
group_by(year, stage) %>%
summarize(avg = mean(bird_weight))
avw
avw <- adw %>%
filter(complete.cases(bird_weight)) %>%
group_by(year, stage) %>%
summarize(avg = mean(bird_weight))
avw
adw <- filter(cc, stage == 'adult' & year > 1990)
avw <- adw %>%
filter(complete.cases(bird_weight)) %>%
group_by(year, stage) %>%
summarize(avg = mean(bird_weight))
avw
dif <- max(avw[,3]) - min(avw[,3])
av <-sum(avw[,3])/nrow(avw)
dif/av
filter(adw, year==2000)
adw %>%
group_by(year)  %>%
summarise(mean(bird_weight, na.rm =T))
## Look at adult weights only
adw <- filter(cc, stage == 'adult' & year > 2000)
##No adult data prior to 2000, nothing in 2001-2004: Is this correct?
## There  are only 3 adult weights in 2000 - they all seem too high: 1125 and 1175 g. Did not use them
avw <- adw %>%
filter(complete.cases(bird_weight)) %>%
group_by(year, stage) %>%
summarize(avg = mean(bird_weight))
avw
dif <- max(avw[,3]) - min(avw[,3])
av <-sum(avw[,3])/nrow(avw)
## trick to force ggplot to include all years in plot
y <- 2005:2017
adw <- rbind(adw, data.frame(year = y[which(!y %in% sort(as.integer(unique(adw$year))))], condition = NA, stage = 'adult'))
adw
## trick to force ggplot to include all years in plot
plotad <- adw %>%
select(year, bird_weight, stage)
y <- 2005:2017
plotad <- rbind(plotad, data.frame(year = y[which(!y %in% sort(as.integer(unique(plotad$year))))], bird_weight = NA, stage = 'adult'))
plotad
g <- ggplot(plotad, aes(year, bird_weight))
g <- g + geom_violin()
g <- g + stat_summary(aes(year), fun.y = mean, geom = "point", fill = "black", shape = 21, size = 1.5)
g <- g + xlab("Year") + ylab('Body weight (g)')
g <- g + theme_cowplot(font_size = 10) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, size = 8))
print(g)
g <- ggplot(plotad, aes(as.factor(year), bird_weight))
g <- g + geom_violin()
g <- g + stat_summary(aes(year), fun.y = mean, geom = "point", fill = "black", shape = 21, size = 1.5)
g <- g + xlab("Year") + ylab('Body weight (g)')
g <- g + theme_cowplot(font_size = 10) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, size = 8))
print(g)
plotad$year
unique(plotad$year)
g <- ggplot(plotad, aes(as.factor(year), bird_weight))
g <- g + geom_violin()
g
g <- g + stat_summary(aes(as.factor(year)), fun.y = mean, geom = "point", fill = "black", shape = 21, size = 1.5)
g
g <- g + xlab("Year") + ylab('Body weight (g)')
g <- g + theme_cowplot(font_size = 10) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, size = 8))
g
print(g)
save_plot("output/AdultWeights.png", g, base_aspect_ratio = 1.4,  base_width = 6, bg = "transparent") # make room for figure legend)
flc <- filter(cc, stage != 'adult' & year > 1990) %>%
select(year, condition, stage)
y <- 1990:2017
flc <- rbind(flc, data.frame(year = y[which(!y %in% sort(as.integer(unique(flc$year))))], condition = NA, stage = 'chick'))
flc[which(flc$condition > 9), 'condition'] <- NA
summary(lm(condition ~ as.integer(year) + as.factor(stage), data = flc))
g <- ggplot(flc, aes(as.factor(year), condition))
g <- g + geom_violin()
g <- g + stat_summary(aes(year), fun.y = mean, geom = "point", fill = "black", shape = 21, size = 1.5)
g <- g + xlab("Year") + ylab('Condition (g/cm)')
g <- g + facet_grid(stage ~ ., scales = "free")
#g <- g + theme_cowplot(font_size = 10) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, size = 8))
g <- g + theme_bw() + theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank())
g <- g + theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust =0, size = 8))
print(g)
## Chick and fledgling condition ----
flc <- filter(cc, stage != 'adult' & year > 1990) %>%
select(year, condition, stage)
flc
## Chick and fledgling condition ----
flc <- filter(cc, stage != 'adult' & year > 1990) %>%
select(year, condition, stage)
y <- 1990:2017
flc <- rbind(flc, data.frame(year = y[which(!y %in% sort(as.integer(unique(flc$year))))], condition = NA, stage = 'chick'))
# get rid of 2 outliers
flc[which(flc$condition > 9), 'condition'] <- NA
summary(lm(condition ~ as.integer(year) + as.factor(stage), data = flc))
## Chick and fledgling condition ----
flc <- filter(cc, stage != 'adult' & year > 1990) %>%
select(year, condition, stage)
y <- 1990:2017
flc <- rbind(flc, data.frame(year = y[which(!y %in% sort(as.integer(unique(flc$year))))], condition = NA, stage = 'chick'))
# get rid of 2 outliers
flc[which(flc$condition > 9), 'condition'] <- NA
summary(lm(condition ~ as.integer(year) + as.factor(stage), data = flc))
g <- ggplot(flc, aes(as.factor(year), condition))
g <- g + geom_violin()
g <- g + stat_summary(aes(as.factor(year)), fun.y = mean, geom = "point", fill = "black", shape = 21, size = 1.5)
g <- g + xlab("Year") + ylab('Condition (g/cm)')
g <- g + facet_grid(stage ~ ., scales = "free")
g <- g + theme_bw() + theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank())
g <- g + theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust =0, size = 8))
print(g)
## Chick and fledgling weight ----
flc <- filter(cc, stage != 'adult' & year > 1990) %>%
select(year, condition, stage, bird_weight)
y <- 1990:2017
flc <- rbind(flc, data.frame(year = y[which(!y %in% sort(as.integer(unique(flc$year))))], condition = NA, stage = 'chick', bird_weight = NA))
flc[which(flc$condition > 9), 'condition'] <- NA
flc[which(flc$bird_weight > 900), 'bird_weight'] <- NA
w <- ggplot(flc, aes(as.factor(year), bird_weight))
w <- w + geom_violin()
w <- w + stat_summary(aes(as.factor(year)), fun.y = mean, geom = "point", fill = "black", shape = 21, size = 1.5)
w <- w + xlab("Year") + ylab('Weight (g)')
w <- w + facet_grid(stage ~ ., scales = "free")
#w <- w + theme_cowplot(font_size = 10) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, size = 8))
w <- w + theme_bw() + theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank())
w <- w + theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0, size = 8))
w
g
## Chick and fledgling wing length ----
wl <- filter(cc, stage != 'adult' & year > 1990) %>%
select(year, stage, winglength)
y <- 1990:2017
wl <- rbind(wl, data.frame(year = y[which(!y %in% sort(as.integer(unique(wl$year))))], stage = 'chick', winglength = NA))
ww <- ggplot(wl, aes(as.factor(year), winglength))
ww <- ww + geom_violin()
ww <- ww + stat_summary(aes(year), fun.y = mean, geom = "point", fill = "black", shape = 21, size = 1.5)
ww <- ww + xlab("Year") + ylab('Wing length (cm)')
ww <- ww + facet_grid(stage ~ ., scales = "free")
#w <- w + theme_cowplot(font_size = 10) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, size = 8))
ww <- ww+ theme_bw() + theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank())
ww <- ww + theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust =0, size = 8))
print(ww)
## Chick and fledgling wing length ----
wl <- filter(cc, stage != 'adult' & year > 1990) %>%
select(year, stage, winglength)
y <- 1990:2017
wl <- rbind(wl, data.frame(year = y[which(!y %in% sort(as.integer(unique(wl$year))))], stage = 'chick', winglength = NA))
ww <- ggplot(wl, aes(as.factor(year), winglength))
ww <- ww + geom_violin()
ww <- ww + stat_summary(aes(as.factor(year)), fun.y = mean, geom = "point", fill = "black", shape = 21, size = 1.5)
ww <- ww + xlab("Year") + ylab('Wing length (cm)')
ww <- ww + facet_grid(stage ~ ., scales = "free")
#w <- w + theme_cowplot(font_size = 10) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, size = 8))
ww <- ww+ theme_bw() + theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank())
ww <- ww + theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust =0, size = 8))
print(ww)
source('D:/Buren_files/GitHub/murre-capelin/capelin-murres/analysis/condtion_plots.R', echo=TRUE)
library(RODBC)
install.packages('RODBC', dependencies = T)
install.packages('readdst', dependencies = T)
devtools::install_github('https://github.com/DistanceDevelopment/readdst')
devtools::install_github('DistanceDevelopment/readdst')
if(!require(devtools) install.packages('devtools'))
if (!require(devtools)) {install.packages("devtools")}
library(readdst)
